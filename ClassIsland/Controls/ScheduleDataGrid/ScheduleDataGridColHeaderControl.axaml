<Styles xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:controls="using:ClassIsland.Controls.ScheduleDataGrid"
        xmlns:ci="http://classisland.tech/schemas/xaml/core"
        xmlns:system="clr-namespace:System;assembly=System.Runtime">
    <Design.PreviewWith>
        <controls:ScheduleDataGridColHeaderControl />
    </Design.PreviewWith>

    <Style Selector="controls|ScheduleDataGridColHeaderControl">
        <!-- Set Defaults -->
        <Setter Property="Margin" Value="0 4 8 4"/>
        <Setter Property="ClipToBounds" Value="False"/>
        <Setter Property="Template">
            <ControlTemplate>
                <Grid RowDefinitions="Auto Auto" >
                    <TextBlock Grid.Row="0" Text="{Binding Date, RelativeSource={RelativeSource TemplatedParent}, StringFormat='ddd'}"/>
                    <TextBlock Grid.Row="0" Text="{Binding Date, RelativeSource={RelativeSource TemplatedParent}, StringFormat='MM/dd'}"
                               HorizontalAlignment="Right"/>
                    <TextBlock Grid.Row="1" 
                               FontSize="14" Foreground="{DynamicResource TextFillColorPrimaryBrush}"
                               Text="{Binding ClassPlan.Name, RelativeSource={RelativeSource TemplatedParent}, FallbackValue='', Mode=OneWay}"/>
                    <StackPanel Grid.Row="1" HorizontalAlignment="Right" Orientation="Horizontal">
                        <TextBlock Margin="2 0 0 0" VerticalAlignment="Center">
                            <TextBlock.Resources>
                                <system:Int32 x:Key="Zero">0</system:Int32>
                            </TextBlock.Resources>
                                                            
                            <TextBlock.IsVisible>
                                <MultiBinding Converter="{x:Static BoolConverters.And}">
                                    <Binding Path="ClassPlan.TimeRule.WeekCountDiv"
                                             Converter="{x:Static ObjectConverters.NotEqual}"
                                             ConverterParameter="{StaticResource Zero}" 
                                             RelativeSource="{RelativeSource TemplatedParent}"/>
                                    <Binding Path="ClassPlan.IsEnabled" RelativeSource="{RelativeSource TemplatedParent}"/>
                                    <Binding Path="!ClassPlan.IsOverlay" RelativeSource="{RelativeSource TemplatedParent}"/>
                                </MultiBinding>
                            </TextBlock.IsVisible>
                                                            
                            <Run Text="{Binding ClassPlan.TimeRule.WeekCountDiv, RelativeSource={RelativeSource TemplatedParent}}" /><Run Text="/" /><Run Text="{Binding ClassPlan.TimeRule.WeekCountDivTotal, RelativeSource={RelativeSource TemplatedParent}}" /><Run Text="周" />
                        </TextBlock>
                        <TextBlock Text="临时层" IsVisible="{Binding ClassPlan.IsOverlay, RelativeSource={RelativeSource TemplatedParent}}"
                                   FontWeight="Bold" FontStyle="Italic" VerticalAlignment="Center"/>
                        
                        <Button Theme="{StaticResource TransparentButton}"
                                Content="{ci:FluentIcon &#xEF27;}"
                                Padding="8 4" Margin="0 -4 -4 -4" />
                    </StackPanel>
                </Grid>
            </ControlTemplate>
        </Setter>
        <Style Selector="^[IsClassPlanEmpty=True]">
            <Setter Property="Template">
                <ControlTemplate>
                    <Grid RowDefinitions="Auto Auto">
                        <TextBlock Grid.Row="0" Text="{Binding Date, RelativeSource={RelativeSource TemplatedParent}, StringFormat='ddd'}"/>
                        <TextBlock Grid.Row="0" Text="{Binding Date, RelativeSource={RelativeSource TemplatedParent}, StringFormat='MM/dd'}"
                                   HorizontalAlignment="Right"/>
                        <TextBlock Grid.Row="1" Text="无课表" FontStyle="Italic"
                                   FontSize="14"/>
                        
                    </Grid>
                </ControlTemplate>
            </Setter>
        </Style>
    </Style>
</Styles>
